---
import RightArrow from "../atoms/Icons/RightArrow.astro";

interface Panel {
  title: string;
  subtitle: string;
  backgroundImage: string;
  decorativeText?: string;
  href: string;
}

interface Props {
  panels: Panel[];
  menuColor?: string;
}

const { panels, menuColor = "white" } = Astro.props;
---

<section
  class="three-panel-section mt-[100px] lg:mt-[110px]"
  data-menu-color={menuColor}
>
  <div class="flex flex-col md:flex-row lg:min-h-[900px]">
    {
      panels.map((panel, idx) => (
        <div
          class={`group panel-item three-panel-section-panel relative flex-1 flex flex-col justify-between bg-cover overflow-hidden lg:pt-[76px] lg:px-[63.5px] lg:pb-[161px] pt-[49.5px] px-[39px] pb-[49.5px] ${idx === 2 ? "bg-bottom" : "bg-center"} ${idx === 1 ? "lg:bg-left" : "bg-center"}`}
          style={`background-image: url('${panel.backgroundImage}');`}
        >
          <div class="three-panel-section-overlay absolute inset-0 bg-black/30 z-0" />

          <div class="relative z-10 flex flex-1 flex-col justify-between">
            <div>
              <h2 class="lg:text-[33px] text-[30px] font-URWClassico lg-mb-[21px] mb-[15px] text-white drop-shadow">
                {panel.title}
              </h2>
              <p class="lg-text-[18px] text-[14px] text-white">
                {panel.subtitle}
              </p>
            </div>
            <div>
              <a
                href={panel.href}
                class="three-panel-section-link flex items-center justify-between w-100 leading-[24px] font-URWClassico pb-[17px] pt-[79px] lg:pt-[101.5px] border-b border-white"
              >
                <span class="text-[16px] lg:text-[18px]">
                  read more <span class="visually-hidden">{panel.title}</span>
                </span>
                <RightArrow class="w-[15px] h-2 transition-transform duration-300 group-hover:translate-x-2" />
              </a>
            </div>
          </div>
        </div>
      ))
    }
  </div>
</section>

<style scoped>
  .three-panel-section-panel {
    transition: box-shadow 0.4s cubic-bezier(0.25, 0.8, 0.25, 1);
    box-shadow: 0 2px 12px 0 rgba(0, 0, 0, 0.06);
  }
  .three-panel-section-panel:hover {
    box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.13);
  }

  .three-panel-section-panel .three-panel-section-overlay {
    transition: background 0.4s cubic-bezier(0.25, 0.8, 0.25, 1);
    background: rgba(0, 0, 0, 0.3);
  }
  .three-panel-section-panel:hover .three-panel-section-overlay {
    background: rgba(0, 0, 0, 0.2);
  }

  .three-panel-section-link {
    position: relative;
    text-decoration: none;
    border-bottom: 1px solid #fff;
  }
  .three-panel-section-link::after {
    content: "";
    position: absolute;
    left: 0;
    right: 0;
    bottom: -1px;
    height: 2px;
    background: rgba(255, 255, 255, 0.7);
    border-radius: 1px;
    transform: scaleX(0);
    transition: transform 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
    transform-origin: left;
    pointer-events: none;
  }
  /* Animate underline when either the link or the panel is hovered */
  .three-panel-section-link:hover::after,
  .three-panel-section-link:focus::after,
  .three-panel-section-panel:hover .three-panel-section-link::after {
    transform: scaleX(1) scaleY(1.5);
    transition: transform 1s cubic-bezier(0.25, 0.8, 0.25, 1);
  }
</style>
