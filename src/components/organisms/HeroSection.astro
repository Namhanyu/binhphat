---
import PageLogo from "../molecules/PageLogo.astro";
import image01 from "../../assets/images/01.webp";
import image02 from "../../assets/images/02.webp";
import clsx from "clsx";

const images = [image01, image02];
---

<section id="hero">
  <div
    class={clsx(
      "h-screen relative",
      "before:absolute before:top-0 before:left-0 before:right-0 before:h-[30vh] before:pointer-events-none before:bg-gradient-to-b before:from-primary before:to-primary/0",
      "after:absolute after:bottom-0 after:left-0 after:right-0 after:h-[30vh] after:pointer-events-none after:bg-gradient-to-t after:from-primary after:to-primary/0",
      "max-md:max-h-[600px]"
    )}
  >
    <div class="keen-slider max-h-screen h-full" id="hero-slider">
      {
        images.map((image) => (
          <div
            class="keen-slider__slide bg-cover bg-center"
            style={`background-image: url(${image.src});`}
          />
        ))
      }
    </div>

    <!-- Custom Pagination -->
    <div
      id="dots"
      class="absolute left-1/2 transform -translate-x-1/2 flex justify-center gap-2 bottom-12 z-10"
    >
    </div>
  </div>

  <!-- Client script -->
  <script>
    import KeenSlider, {
      KeenSliderHooks,
      KeenSliderInstance,
    } from "keen-slider";

    new KeenSlider("#hero-slider", {
      loop: true,
      slideChanged(s) {
        updateDots(s.track.details.rel);
      },
      created(s) {
        createDots(s);
        updateDots(s.track.details.rel);
      },
    });

    function createDots(slider: KeenSliderInstance<{}, {}, KeenSliderHooks>) {
      const dotsContainer = document.getElementById("dots");
      const slides = slider.track.details.slides.length;
      for (let i = 0; i < slides; i++) {
        const dot = document.createElement("button");
        dot.classList.add(
          "w-3",
          "h-3",
          "rounded-full",
          "bg-white",
          "border",
          "border-white"
        );
        dot.addEventListener("click", () => slider.moveToIdx(i));
        dotsContainer?.appendChild(dot);
      }
    }

    function updateDots(activeIdx: number) {
      const dots = document.getElementById("dots")?.children || [];
      Array.from(dots).forEach((dot, idx) => {
        dot.classList.toggle("bg-primary", idx === activeIdx);
        dot.classList.toggle("bg-white", idx !== activeIdx);
      });
    }
  </script>
</section>

<PageLogo />
